// Adaptive Mixins - Intelligent CSS patterns
// Performance-optimized mixins that adapt to context and capabilities

// 1. Adaptive Container Queries
@mixin adaptive-container(
	$breakpoints: (
		sm: 320px,
		md: 640px,
		lg: 1024px,
	)
) {
	container-type: inline-size;

	@each $name, $size in $breakpoints {
		@container (min-width: #{$size}) {
			&.container-#{$name} {
				@content;
			}
		}
	}

	// Fallback for browsers without container query support
	@supports not (container-type: inline-size) {
		@each $name, $size in $breakpoints {
			@media (min-width: #{$size}) {
				&.fallback-#{$name} {
					@content;
				}
			}
		}
	}
}

// 2. Performance-Optimized Animations
@mixin adaptive-animation(
	$name,
	$duration: 0.3s,
	$easing: cubic-bezier(0.4, 0, 0.2, 1)
) {
	animation: #{$name} #{$duration} #{$easing};

	// Hardware acceleration
	will-change: transform, opacity;
	transform: translateZ(0);
	backface-visibility: hidden;

	// Respect user preferences
	@media (prefers-reduced-motion: reduce) {
		animation-duration: 0.01ms;
		animation-iteration-count: 1;
	}

	// Performance mode for low-end devices
	.performance-mode & {
		animation: none;
		will-change: auto;
	}
}

// 3. Intelligent Focus Management
@mixin adaptive-focus(
	$color: var(--byte-primary-500),
	$width: 2px,
	$offset: 2px
) {
	&:focus {
		outline: none; // Remove default outline
	}

	&:focus-visible {
		outline: #{$width} solid #{$color};
		outline-offset: #{$offset};

		// High contrast mode support
		@media (prefers-contrast: high) {
			outline-color: Highlight;
			outline-width: 3px;
		}
	}

	// Touch device optimization
	@media (hover: none) {
		&:focus {
			outline: #{$width} solid #{$color};
			outline-offset: #{$offset};
		}
	}
}

// 4. Adaptive Typography
@mixin adaptive-text($base-size: 1rem, $scale: 1.25, $line-height: 1.5) {
	font-size: #{$base-size};
	line-height: #{$line-height};

	// Fluid typography
	font-size: clamp(
		#{$base-size * 0.875},
		#{$base-size} + 0.5vw,
		#{$base-size * $scale}
	);

	// Container-based scaling
	container-type: inline-size;

	@container (max-width: 300px) {
		font-size: #{$base-size * 0.875};
		line-height: #{$line-height * 0.9};
	}

	@container (min-width: 800px) {
		font-size: #{$base-size * 1.125};
	}
}
